---
title: Chapter 02. Kafka ì„¤ì¹˜í•˜ê¸°(WSL ğŸ§)
date: 2024-11-17 22:20:00 +0900
categories: [ì¹´í”„ì¹´ í•µì‹¬ê°€ì´ë“œ]
tags: [ì¹´í”„ì¹´ í•µì‹¬ê°€ì´ë“œ]
---

## **1. WSL ì„¤ì¹˜**
- **[Microsoft ê³µì‹ ë¬¸ì„œ](https://learn.microsoft.com/ko-kr/windows/wsl/install) ì°¸ê³ **

---

## **2. Java ì„¤ì¹˜ ë° í™•ì¸**
- **OpenJDK ì„¤ì¹˜**

```bash
sudo apt update && sudo apt install openjdk-17-jdk
```

- **Java ë²„ì „ í™•ì¸**

```bash
java -version
```

---

## **3. ì‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±**
- **`home/<user>` ê²½ë¡œ ì•„ë˜ ë””ë ‰í† ë¦¬ ìƒì„±**

```bash
mkdir -p ~/.local/tmp
```

---

## **4. Zookeeper ì„¤ì¹˜**
- **`~/.local/tmp` ê²½ë¡œë¡œ ì´ë™**

```bash
cd ~/.local/tmp
```

- **ì•„ë˜ ëª…ë ¹ì–´ ì‹¤í–‰**

```bash
wget https://dlcdn.apache.org/zookeeper/zookeeper-3.9.3/apache-zookeeper-3.9.3-bin.tar.gz
tar -xvzf apache-zookeeper-3.9.3-bin.tar.gz
```

- **ì••ì¶• í•´ì œí•œ í´ë”ë¥¼ `.local`ë¡œ ì´ë™ í›„ ì´ë¦„ ë³€ê²½**

```bash
mv apache-zookeeper-3.9.3-bin ~/.local/zookeeper
```

---

## **5. Kafka ì„¤ì¹˜**
- **Kafka 3.9.0 ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ**

```bash
wget https://dlcdn.apache.org/kafka/3.9.0/kafka_2.12-3.9.0.tgz
tar -xvzf kafka_2.12-3.9.0.tgz
```

- **ì••ì¶• í•´ì œí•œ í´ë”ë¥¼ `.local`ë¡œ ì´ë™ í›„ ì´ë¦„ ë³€ê²½**

```bash
mv kafka_2.12-3.9.0 ~/.local/kafka
```

---

## **6. Zookeeper ì‹¤í–‰**
- **Zookeeper ì‹¤í–‰**

```bash
cd ~/.local/zookeeper/bin
./zkServer.sh start
```

![zookeeper](https://github.com/user-attachments/assets/99f48526-aea9-48d2-97e1-758e3d5819f5)


---

## **7. Kafka ë¸Œë¡œì»¤ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**
- **`.local` ì•„ë˜ì— `start_kafka_broker.sh` íŒŒì¼ ìƒì„±**

```bash
#!/bin/bash

KAFKA_HOME=/home/$USER/.local/kafka
KAFKA_PROPERTIES=$KAFKA_HOME/config/server.properties

echo "=================================="
echo "KAFKA_HOME: $KAFKA_HOME"
echo "KAFKA_PROPERTIES: $KAFKA_PROPERTIES"
echo "=================================="

echo "Starting Kafka Broker"

# Error Handling
error_handling() {
  echo "=================================="
  echo " [ERROR] Kafka Broker failed to start."
  echo "=================================="
  exit 1
}

# Check Path
if [ ! -d "$KAFKA_HOME" ]; then
  echo "=================================="
  echo " [ERROR] Kafka Home directory not found: $KAFKA_HOME"
  echo "=================================="
  error_handling
fi

if [ ! -f "$KAFKA_PROPERTIES" ]; then
  echo "=================================="
  echo " [ERROR] Kafka Properties file not found: $KAFKA_PROPERTIES"
  echo "=================================="
  error_handling
fi

echo "Kafka Home: $KAFKA_HOME"
echo "Kafka Properties: $KAFKA_PROPERTIES"

# Kafka Broker ì‹œì‘
$KAFKA_HOME/bin/kafka-server-start.sh -daemon $KAFKA_PROPERTIES

# Kafka ì‹œì‘ ìƒíƒœ í™•ì¸
if [ $? -ne 0 ]; then
  error_handling
fi

echo "Kafka Broker Started successfully"

```

- **ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬**

```bash
chmod +x ~/.local/start_kafka_broker.sh
```

- **Kafka ë¸Œë¡œì»¤ ì‹¤í–‰**

```bash
~/.local/start_kafka_broker.sh
```

![kafaka-broker](https://github.com/user-attachments/assets/c382077b-a5c2-479a-bd3d-a48c1b1974fd)

---

## **8. ê°„ë‹¨í•œ í† í”½ ìƒì„± ë° ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  ì‹¤ìŠµ**

### **8-1. í† í”½ ìƒì„±**
- **Kafkaì—ì„œ ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ê¸° ìœ„í•´ `test` í† í”½ ìƒì„±**

```bash
~/.local/kafka/bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --replication-factor 1 --partitions 1 --topic test
```

![kafka1](https://github.com/user-attachments/assets/27f091b3-a069-41db-acf5-c19ee1ffcf1f)

### **8-2. í† í”½ ì •ë³´ í™•ì¸**
- **ìƒì„±í•œ í† í”½ì˜ ìƒì„¸ ì •ë³´ í™•ì¸**

```bash
~/.local/kafka/bin/kafka-topics.sh --bootstrap-server localhost:9092 --describe --topic test
```

- **ì¶œë ¥ ì •ë³´**
    - íŒŒí‹°ì…˜ ìˆ˜, ë¦¬í”Œë¦¬ì¼€ì´ì…˜ íŒ©í„° ë“± í† í”½ì˜ ê¸°ë³¸ ì„¤ì •ê°’ í‘œì‹œ

![kafka2](https://github.com/user-attachments/assets/1d724bca-b060-4658-8e8a-a98d85b10c0f)


### **8-3. í† í”½ì— ë©”ì‹œì§€ ì“°ê¸°**
- **`kafka-console-producer.sh`ë¥¼ ì‚¬ìš©í•´ `test` í† í”½ì— ë©”ì‹œì§€ ì „ì†¡**

```bash
~/.local/kafka/bin/kafka-console-producer.sh --bootstrap-server localhost:9092 --topic test
```

- **ë©”ì‹œì§€ ì…ë ¥**
    - ì…ë ¥ëœ ë©”ì‹œì§€ëŠ” Kafka ë¸Œë¡œì»¤ë¥¼ í†µí•´ ì €ì¥ë¨

```bash
> TestMessage1
> TestMessage2
```

![kafka3](https://github.com/user-attachments/assets/7f02ce35-da7d-4d91-847a-4bfa7a0e94a1)


### **8-4. í† í”½ì—ì„œ ë©”ì‹œì§€ ì½ê¸°**
- **`kafka-console-consumer.sh`ë¥¼ ì‚¬ìš©í•´ ì €ì¥ëœ ë©”ì‹œì§€ ì½ê¸°**

```bash
~/.local/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning
```

- **ì¶œë ¥ê²°ê³¼**
    - í† í”½ì— ì €ì¥ëœ ë©”ì‹œì§€ê°€ ìˆœì„œëŒ€ë¡œ í‘œì‹œ
    - `--from-beginning` ì˜µì…˜ì„ í†µí•´ ê¸°ì¡´ ë©”ì‹œì§€ ëª¨ë‘ ì½ê¸° ê°€ëŠ¥

![kafka4](https://github.com/user-attachments/assets/86f682d7-f195-4b12-8474-93023c921026)

