---
title: Item 18 - ìƒì†ë³´ë‹¤ëŠ” ì»´í¬ì§€ì…˜ì„ ì‚¬ìš©í•˜ë¼
date: 2024-08-25 00:48:00 +0900
categories: [ì´í™í‹°ë¸Œ ìë°”, chapter3]
tags: [ì´í™í‹°ë¸Œ ìë°”]
---

ìƒì†ì€ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ê°•ë ¥í•œ ìˆ˜ë‹¨ì´ì§€ë§Œ í•­ìƒ ìµœì„ ì€ ì•„ë‹ˆë‹¤. 

## **ìƒì†ì˜ ë¬¸ì œì **
ì•„ë˜ì˜ í´ë˜ìŠ¤ëŠ” ì •ìƒì ìœ¼ë¡œ ë³´ì´ì§€ë§Œ ë¬¸ì œê°€ ìˆë‹¤.

```java
public class InstrumentedHashSet<E> extends HashSet<E> {
    private int addCount = 0;
    
    public InstrumentedHashSet() {}
    
    public InstrumentedHashSet(int initialCapacity, float loadFactor) {
        super(initialCapacity, loadFactor);
    }
    
    @Override
    public boolean add(E e) {
        addCount += 1;
        return super.add(e);
    }
    
    @Override
    public boolean addAll(Collection<? extends E> c) {
        addCount += c.size();
        return super.addAll(c);
    }
    
    public int getAddCount() {
        return addCount;
    }
}
```


ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•œë‹¤ê³  ê°€ì •í•˜ì.

3ê°œì˜ ì›ì†Œê°€ ì¶”ê°€ë˜ì—ˆìœ¼ë‹ˆ `getAddAcount`ë¥¼ í˜¸ì¶œí•˜ë©´ 3ì´ ë°˜í™˜ë˜ì–´ì•¼ í•˜ëŠ”ë°, 6ì´ ë°˜í™˜ëœë‹¤.

```java
InstrumentedHashSet<String> s = new InstrumentedHashSet<>();
s.addAll(List.of("í‹±", "íƒíƒ", "í‘"));
```
HashSetì˜ `addAll`ì€ ì•„ë˜ì˜ ì½”ë“œë¡œ ì‹¤í–‰ëœë‹¤.

`add`ê°€ ì•ˆì—ì„œ í˜¸ì¶œë˜ëŠ”ë°, ì¬ì •ì˜í•œ `add`ì™€ `addAll` ëª¨ë‘ addCountë¥¼ ì¦ê°€ì‹œì¼œ 6ì„ ë°˜í™˜í•œë‹¤.

![addAll](https://github.com/user-attachments/assets/cf30f90f-2d99-4611-bf0b-f24b1e802d3d)


### **ë¬¸ì œ í•´ê²° ë°©ë²• ğŸ¤”..?**

**addAll ë©”ì„œë“œë¥¼ ì¬ì •ì˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° (HashSetì˜ addAllì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°)**
- HashSetì˜ `addAll` ë©”ì„œë“œê°€ `add`ë¥¼ í†µí•´ êµ¬í˜„í–ˆìŒì„ ê°€ì •í•œ í•´ë²•ì´ë¼ëŠ” í•œê³„ê°€ ìˆë‹¤.
- `addAll`ì€ HashSetì´ êµ¬í˜„í•˜ëŠ” ë©”ì„œë“œì— ì „ì ìœ¼ë¡œ ë‹¬ë ¤ìˆë‹¤.
    - ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ì—ì„œ ë‹¤ë¥´ê²Œ ì ìš©ëœë‹¤ë©´ ê¹¨ì§€ê¸° ì‰½ë‹¤.

**addAll ë©”ì„œë“œë¥¼Â ì¬ì •ì˜í•˜ëŠ” ê²½ìš° (InstrumetedHashSetì—ì„œ ìƒˆë¡œ addAllì„ ì¬ì •ì˜í•˜ëŠ” ê²½ìš°)**
- HashSetì˜ ë©”ì„œë“œë¥¼ ë” ì´ìƒ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë‹ˆ `addAll`ì´ `add`ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ìƒê´€ì—†ì–´ì§„ë‹¤.
- ìƒìœ„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œì™€ ë˜‘ê°™ì´ ë™ì‘í•˜ë„ë¡ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ë°, ì´ ë°©ì‹ì€ ì–´ë ¤ìš¸ ìˆ˜ë„ ìˆìœ¼ë©°, ì‹œê°„ë„ ë” ë“¤ê³ , ì˜¤ë¥˜ ë° ì„±ëŠ¥ ì €í•˜ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆë‹¤.
- ë§Œì•½, í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” private í•„ë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ë©´ êµ¬í˜„ ìì²´ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.


## **ì»´í¬ì§€ì…˜**
- **ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³  private í•„ë“œë¡œ ê¸°ì¡´ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ê²Œ í•˜ëŠ” ê²ƒ**
- ìƒˆ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œë“¤ì€ ê¸°ì¡´ í´ë˜ìŠ¤ì— ëŒ€ì‘í•˜ëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ê·¸ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
- ê¸°ì¡´ í´ë˜ìŠ¤ì˜ êµ¬í˜„ì´ ë°”ë€Œê±°ë‚˜, ìƒˆë¡œìš´ ë©”ì„œë“œê°€ ìƒê¸°ë”ë¼ë„ ì•„ë¬´ëŸ° ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.

ìƒì†ìœ¼ë¡œ êµ¬í˜„í–ˆë˜ ì˜ˆì œë¥¼ **ì»´í¬ì§€ì…˜**ìœ¼ë¡œ ë°”ê¿”ë³´ì.

```java
public class InstrumentedSet<E> extends FowardingSet<E> {
    private int addCount = 0;
    public InstrumentedSet(Set<E> s) {
        super(s);
    }
    
    @Override
    public boolean add(E e) {
        addCount++;
        super.add(e);
    }
    
    @Override
    public boolean addAll(Collection<? extends E> c) {
        addCount += c.size();
        return super.addAll(c);
    }
		
    public int getCount() {
        return addCount;
    }
}
```

```java
public class ForwardingSet<E> implements Set<E> {
    // ê¸°ì¡´ í´ë˜ìŠ¤ë¥¼ private ì¸ìŠ¤í„´ìŠ¤ë¡œ ìƒì„±
    private final Set<E> s;
    public ForwardingSet(Set<E> s) { this.s = s; }

    public void clear()                 { s.clear(); }
    public boolean contains(Object o)   { return s.contains(o); }
    public boolean isEmpty()            { return s.isEmpty(); }
    public int size()                   { return s.size(); }
    public Iterator<E> iterator()       { return s.iterator();}
    public boolean add(E e)             { return s.add(e); }
    public boolean remove(Object o)     { return s.remove(o); }
    public boolean containsAll(Collection<?> c) { return s.containsAll(c); }
    public boolean addAll(Collection<? extends E> c) {return s.addAll(c); }
    public boolean removeAll(Collection<?> c) { return s.removeAll(c); }
    public boolean retainAll(Collection<?> c) { return s.retainAll(c); }

    public Object[] toArray()                 { return s.toArray(); }
    public <T> T[] toArray(T[] a)             { return s.toArray(a); }

    @Override public int hashCode()           { return super.hashCode();}

    @Override public boolean equals(Object obj) { return super.equals(obj); }

    @Override public String toString()          { return super.toString(); }
}
```
- Set ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°ì‹¸ê³  ìˆëŠ” InstrumentedSet í´ë˜ìŠ¤ë¥¼ ë˜í¼ í´ë˜ìŠ¤(Wrapper Class)ë¼ í•œë‹¤.
- ë‹¤ë¥¸ Setì— ê¸°ëŠ¥ì„ ë§ì”Œìš´ë‹¤ëŠ” ëœ»ì—ì„œ ë°ì½”ë ˆì´í„° íŒ¨í„´(Decorator Pattern)ì´ë¼ê³  í•œë‹¤.


## **ğŸ’¡ í•µì‹¬ ì •ë¦¬**
- ìƒì†ì€ ê°•ë ¥í•˜ì§€ë§Œ ìº¡ìŠí™”ë¥¼ í•´ì¹œë‹¤.
- ê·¸ë˜ì„œ ë°˜ë“œì‹œ í´ë˜ìŠ¤ ê°„ì— is-a ê´€ê³„ì¼ ë•Œë§Œ ì‚¬ìš©í•´ì•¼í•œë‹¤.
- ì»´í¬ì§€ì…˜ì„ ì‚¬ìš©í•´ì•¼í•  ìƒí™©ì—ì„œ ìƒì†ì„ ì‚¬ìš©í•˜ëŠ”ê±´ ë‚´ë¶€ êµ¬í˜„ì„ ë¶ˆí•„ìš”í•˜ê²Œ ë…¸ì¶œí•˜ëŠ” ê²ƒì´ë‹¤.
- í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìƒìœ„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ì—¬ í•˜ìœ„ í´ë˜ìŠ¤ì˜ ë¶ˆë³€ì‹ì„ í•´ì¹  ìˆ˜ë„ ìˆë‹¤.
- ì›¬ë§Œí•˜ë©´ ìƒì† ëŒ€ì‹  ì»´í¬ì§€ì…˜ê³¼ ì „ë‹¬ì„ ì‚¬ìš©í•˜ì.
